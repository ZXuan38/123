(function(t){function e(e){for(var i,o,r=e[0],l=e[1],c=e[2],d=0,u=[];d<r.length;d++)o=r[d],Object.prototype.hasOwnProperty.call(n,o)&&n[o]&&u.push(n[o][0]),n[o]=0;for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(t[i]=l[i]);h&&h(e);while(u.length)u.shift()();return a.push.apply(a,c||[]),s()}function s(){for(var t,e=0;e<a.length;e++){for(var s=a[e],i=!0,r=1;r<s.length;r++){var l=s[r];0!==n[l]&&(i=!1)}i&&(a.splice(e--,1),t=o(o.s=s[0]))}return t}var i={},n={app:0},a=[];function o(e){if(i[e])return i[e].exports;var s=i[e]={i:e,l:!1,exports:{}};return t[e].call(s.exports,s,s.exports,o),s.l=!0,s.exports}o.m=t,o.c=i,o.d=function(t,e,s){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(o.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)o.d(s,i,function(e){return t[e]}.bind(null,i));return s},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],l=r.push.bind(r);r.push=e,r=r.slice();for(var c=0;c<r.length;c++)e(r[c]);var h=l;a.push([0,"chunk-vendors"]),s()})({0:function(t,e,s){t.exports=s("56d7")},"56d7":function(t,e,s){"use strict";s.r(e);var i=s("a026"),n=s("7496"),a=s("8336"),o=s("b0af"),r=s("62ad"),l=s("132d"),c=s("f6c4"),h=s("0fd9"),d=s("8654"),u=s("a844"),p=(s("5b81"),function(){var t=this,e=t._self._c;return e(n["a"],[e(c["a"],[e(h["a"],[e(r["a"],{attrs:{cols:"6"}},[e(o["a"],[e(d["a"],{model:{value:t.cookies,callback:function(e){t.cookies=e},expression:"cookies"}}),e(a["a"],{on:{click:function(e){t.设置cookies(t.cookies)}}},[t._v("设置cookies")]),e(d["a"],{model:{value:t.newGzdbh,callback:function(e){t.newGzdbh=e},expression:"newGzdbh"}}),e(a["a"],{on:{click:function(e){new t.计量配表.配表流程(t.newGzdbh.replaceAll(" ","").replaceAll("\t",""))}}},[t._v("新增单个任务")])],1)],1),e(r["a"],{attrs:{cols:"6"}},[e(o["a"],[e(u["a"],{model:{value:t.muiltTask,callback:function(e){t.muiltTask=e},expression:"muiltTask"}}),t._v(" "+t._s(t.muiltTask.split("\n").filter(t=>t.length).length)+" "),e(a["a"],{on:{click:function(e){t.muiltTask.split("\n").filter(t=>t.length).forEach(e=>{new t.计量配表.配表流程(e.replaceAll(" ","").replaceAll("\t",""))})}}},[t._v("新增全部任务")]),e(a["a"],{on:{click:function(e){t.计量配表.配表队列.forEach(t=>t.检查())}}},[t._v("全部检查")]),e(a["a"],{on:{click:function(e){t.计量配表.配表队列.forEach((t,e)=>{t.打印服务情况表(t.gzdbh,"excel","序号"+("000"+(e+1)).substr(-3)+" "+t.gzdbh)})}}},[t._v("全部下载excel")]),e(a["a"],{on:{click:function(e){t.制表()}}},[t._v("制表")])],1)],1)],1),e(h["a"],t._l(t.计量配表.配表队列,(function(s,i){return e(r["a"],{key:s.gzdbh,attrs:{cols:"12"}},[e(o["a"],[e(h["a"],[e("JRalert",{attrs:{myValue:s.信息检验.工作单类别}}),e("JRalert",{attrs:{myValue:s.信息检验.工作单环节}}),e("div",[t._v("序号："+t._s(i+1)+"/"+t._s(t.计量配表.配表队列.length)+" 工单编号："+t._s(s.gzdbh))]),e(r["a"],{attrs:{cols:"8"}},[e("div",[t._v("用户编号："+t._s(s.yhbh))]),e("div",[t._v("---摘要地址："+t._s(s.gzdzy&&s.gzdzy.用电地址))]),e("div",[t._v("---摘要类别："+t._s(s.gzdzy&&s.gzdzy.主用电类别))]),e("div",[t._v("---摘要电压："+t._s(s.gzdzy&&s.gzdzy.供电电压))]),e("div",[t._v("---摘要户名："+t._s(s.gzdzy&&s.gzdzy.用户名称))]),e("JRalert",{attrs:{myValue:s.信息检验.勘查信息}}),e("JRalert",{attrs:{myValue:s.信息检验.勘查分析}}),e("div",[t._v("当前表计："+t._s(s.info.表计状态))]),e("div",[t._v("当前表箱："+t._s(s.info.配箱状态))]),e("div",[t._v("工作状态："+t._s(s.info.state))]),e(a["a"],{on:{click:function(t){s.检查()}}},[t._v("检查")]),e(a["a"],{on:{click:function(t){s.配备(82,!1)}}},[t._v("配单60无箱")]),e(a["a"],{on:{click:function(t){s.配备(83,!0)}}},[t._v("配单80+箱")]),e(a["a"],{on:{click:function(t){s.配备(84,!0)}}},[t._v("配三相+箱")]),e(a["a"],{on:{click:function(t){s.配备(79,!0)}}},[t._v("配三相互感+箱")]),e(a["a"],[t._v("手动配备")]),e(a["a"],{on:{click:function(t){s.配备(82,!0)}}},[t._v("配单60+多位")]),e(a["a"],{on:{click:function(t){s.配备(84,!1)}}},[t._v("配三相+无箱")]),e(a["a"],{on:{click:function(t){s.配备(79,!1)}}},[t._v("配三相互感+无箱")]),e(a["a"],{attrs:{color:"#217346",dark:""},on:{click:function(t){s.打印服务情况表(s.gzdbh,"excel",s.gzdbh)}}},[t._v("打excel "),e(l["a"],{attrs:{dark:""}},[t._v(" mdi-microsoft-excel ")])],1),e(a["a"],{attrs:{color:"error"},on:{click:function(t){s.移除()}}},[t._v("删除")]),e(a["a"],{on:{click:function(t){s.强制打开配图界面()}}},[t._v("强制配图")]),e(a["a"],{attrs:{hidden:""},on:{click:function(t){s.保存表箱信息()}}},[t._v("保存表箱信息")])],1),t._l(s.信息检验.勘查分析.multiMuiltmeasureEntitiesInfo,(function(s,i){return e(r["a"],{key:i,attrs:{cols:"2"}},[e("div",[t._v("计量点"+t._s(i+1))]),e("div",[t._v(" "+t._s(s.suggestion&&s.suggestion.conclusion))]),e("div",[t._v(t._s(s.分析&&s.分析.新计量点信息.YDRL)+"kw")]),e("div",[t._v(t._s(t.database.电价信息[s.分析.新计量点信息.DJDM].电价))]),e("div",[t._v(" 已配 "+t._s(s.分析.测试))]),e("div",[t._v(" 已配 "+t._s(s.表箱信息.状态))]),t._l(s.suggestion.buttons,(function(s,i){return e(a["a"],{key:i,on:{click:function(t){return s.func()}}},[t._v(t._s(s.des))])}))],2)}))],2)],1)],1)})),1)],1)],1)}),f=[];const g="36001001\t居民电价(一户多人口)\t居民生活\t不满1千伏\n36001002\t居民合表电价(一户多人口)\t居民生活\t不满1千伏\n31006001\t大工业220千伏及以上\t大工业用电\t220千伏及以上\n31006003\t大工业220千伏及以上（发电厂用网电价）\t大工业用电\t220千伏及以上\n31006005\t大工业220千伏及以上（电动汽车）\t大工业用电\t220千伏及以上\n31006011\t大工业蓄冷电价(220千伏及以上)\t大工业用电\t220千伏及以上\n32001001\t普通工业不满1千伏\t普通工业\t不满1千伏\n32001002\t非工业1千伏以下\t非工业\t不满1千伏\n32001003\t农村饮水工程\t农业生产\t10千伏\n32001004\t普通工业不满1千伏（污水处理）\t普通工业\t不满1千伏\n32001006\t中小化肥普通工业不满1千伏\t普通工业\t不满1千伏\n32001008\t普通工业不满1千伏（电动汽车）\t普通工业\t不满1千伏\n32001017\t非工业蓄冷电价(不满1千伏)\t非工业\t不满1千伏\n32001019\t普通工业蓄冷电价(不满1千伏)\t普通工业\t不满1千伏\n32002001\t普通工业1-10千伏\t普通工业\t10千伏\n32002002\t非工业1-10千伏\t非工业\t10千伏\n32002003\t普通工业1－10千伏（污水处理）\t普通工业\t10千伏\n32002005\t中小化肥普通工业1-10千伏\t普通工业\t10千伏\n32002008\t普通工业1-10千伏（电动汽车）\t普通工业\t1-10千伏\n32002013\t普通工业蓄冷电价(1－10千伏)（弃用）\t普通工业\t10千伏\n32002014\t非工业蓄冷电价(1－10千伏)\t非工业\t10千伏\n32002099\t普通工业1-10千伏（港口岸电、污水处理、海水淡化）\t普通工业\t1-10千伏\n32002101\t广佛地铁\t普通工业\t35-110千伏\n32003201\t普通工业35千伏及以上\t普通工业\t35-110千伏\n32003202\t非工业35千伏及以上\t非工业\t35-110千伏\n32003205\t非工业蓄冷电价(35千伏及以上)\t非工业\t35-110千伏\n32004001\t甘竹滩洪潮发电站（小水电电价）\t普通工业\t110千伏\n32004002\t高明发电站（小水电电价）\t普通工业\t110千伏\n33001001\t商业1千伏以下\t商业\t不满1千伏\n33001002\t商业(平价商店)1千伏以下\t商业\t不满1千伏\n33001003\t农产品不满1千伏\t商业\t不满1千伏\n33002001\t商业1-10千伏\t商业\t10千伏\n33002002\t商业(平价商店)1-10千伏\t商业\t10千伏\n33002003\t农产品1-10千伏\t商业\t10千伏\n33003202\t农产品35千伏及以上\t商业\t35-110千伏\n33003401\t商业35千伏\t商业\t35千伏\n33003403\t商业蓄冷电价(1－10千伏)\t商业\t10千伏\n33003404\t商业蓄冷电价(35千伏及以上)\t商业\t35-110千伏\n33003405\t商业蓄冷电价(不满1千伏)\t商业\t不满1千伏\n35001001\t居民电价\t居民生活\t不满1千伏\n35001002\t居民合表电价\t居民生活\t不满1千伏\n35001004\t教学用电不满1千伏\t非居民\t不满1千伏\n35002001\t教学用电1-10千伏\t非居民\t10千伏\n35002002\t住宅用电1-10千伏\t居民生活\t10千伏\n37001001\t农业生产1千伏以下\t农业生产\t不满1千伏\n37002001\t农业生产1-10千伏\t农业生产\t10千伏\n38001001\t稻田排灌1千伏以下\t农业排灌\t不满1千伏\n38002001\t稻田排灌1-10千伏\t农业排灌\t10千伏\n39002101\t光伏发电电价\t其它用电\t10千伏\n39004001\t高明发电站（小水电电价新）\t普通工业\t110千伏\n32603299\t非工业35千伏及以上（通信基站分时）\t非工业\t35-110千伏\n31003106\t大工业35-110千伏及以上（电动汽车）\t大工业用电\t35-110千伏\n31003119\t大工业蓄冷电价(35-110千伏)\t大工业用电\t35-110千伏\n31002099\t大工业1-10千伏（港口岸电、污水处理、海水淡化）\t大工业用电\t1-10千伏\n31003101\t大工业35-110千伏\t大工业用电\t35-110千伏\n31003102\t大工业35-110千伏（限制类水泥企业差别电价）\t大工业用电\t35-110千伏\n31003104\t大工业35-110千伏（发电厂用网电价）\t大工业用电\t35-110千伏\n32101004\t大工业蓄冷电价(1-10千伏)\t大工业用电\t1-10千伏\n32201004\t普通工业蓄冷电价(1－10千伏)\t普通工业\t10千伏\n00000000\t无电价\t其它用电\t不满1千伏\n31001001\t氯碱行业生产用电\t大工业用电\t1-10千伏\n32601099\t非工业不满1千伏（通信基站分时）\t非工业\t不满1千伏\n32602099\t非工业1-10千伏（通信基站分时）\t非工业\t1-10千伏\n32602299\t非工业20千伏（通信基站分时）\t非工业\t20千伏\n31001002\t农村饮水工程(大工业)\t农业生产\t1-10千伏\n31002001\t大工业1-10千伏\t大工业用电\t1-10千伏\n31002008\t中小化肥大工业1-10千伏\t大工业用电\t1-10千伏\n31002010\t大工业1-10千伏（污水处理电价）\t大工业用电\t1-10千伏\n31002012\t大工业1-10千伏（发电厂用网电价）\t大工业用电\t1-10千伏\n31002013\t大工业1-10千伏（小水电电价）\t大工业用电\t10千伏\n31002032\t大工业蓄冷电价(1-10千伏)（弃用）\t大工业用电\t1-10千伏\n31002085\t大工业1-10千伏（电动汽车）\t大工业用电\t1-10千伏\n34002001\t一般工商业220KV\t普通工业\t220千伏及以上\n";let m={};g.split("\n").filter(t=>t.length).map(t=>t.split("\t")).forEach(t=>{m[t[0]]={"电价":t[1],"性质":t[2],"电压":t[3]}});const x={"单相":{name:"单相表箱",sealingStampSlot:1,data:{wzplbm:"010039102223",bxlxdm:"1041001"}},"三相":{name:"三相表箱",sealingStampSlot:1,data:{wzplbm:"010039102511",bxlxdm:"1041002"}}},D={82:{name:"单相60A",sealingStampSlot:1,data:{BDDLDM:"82",XXLBDM:"01",EDDYDM:"1",ZQDDJDM:"47"},withbox:x.单相},83:{name:"单相80A",sealingStampSlot:1,data:{BDDLDM:"83",XXLBDM:"01",EDDYDM:"1",ZQDDJDM:"47"},withbox:x.单相},84:{name:"三相直入",sealingStampSlot:2,data:{BDDLDM:"84",XXLBDM:"03",EDDYDM:"2",ZQDDJDM:"51"},withbox:x.三相},79:{name:"三相互感",sealingStampSlot:2,data:{BDDLDM:"79",XXLBDM:"03",EDDYDM:"2",ZQDDJDM:"51"},withbox:x.三相},"加单相表封":{},"加三相表封":{}},b={10:"3(6)A",11:"3(10)A",12:"5A",13:"5(6)A",14:"5(10)A",15:"5(15)A",16:"5(20)A",17:"5(30)A",18:"5(40)A",19:"10A",20:"10(20)A",21:"10(40)A",22:"10(60)A",23:"15A",24:"15(30)A",25:"20A",26:"20(40)A",27:"20(80)A",28:"25A",29:"25(50)A",30:"30A",31:"30(60)A",32:"30(100)A",33:"40A",34:"50A",35:"80A",36:"90A",37:"0.3(1.2)A",38:"1A",39:"2(10)A",40:"1(2)A",41:"1(5)A",42:"1.5(5)A",43:"1.5(10)A",44:"1.5(30)A",45:"2(3)A",46:"2(4)A",47:"2(6)A",48:"2.5(6)A",49:"2.5(15)A",50:"2.5(60)A",51:"3(20)A",52:"3(30)A",53:"5(60)A",54:"5(100)A",55:"10(30)A",56:"10(80)A",57:"10(100)A",58:"15(20)A",59:"15(60)A",60:"15(90)A",62:"40(60)A",63:"40(80)A",65:"5(150)A",66:"1(4)A",67:"3(5)A",68:"1.5(9)A",69:"1.5(15)A",70:"2.5(20)A",71:"3(2)A",72:"20(100)A",73:"5(80)A",75:"10(400)A",76:"0.1-0.5(60)A",77:"0.1-0.5(80)A",78:"0.1-0.5(100)A",79:"0.01-0.05(10)A",80:"0.003-0.015(1.2)A",81:"125A",82:"0.25-0.5(60)A",83:"0.25-0.5(80)A",84:"0.2-0.5(80)A",88:"630A",89:"800A",90:"100(800)A",91:"400A",92:"250A","01":"1(6)A","02":"1(10)A","03":"1.5A","04":"1.5(6)A","05":"2A","06":"2.5A","07":"2.5(5)A","08":"2.5(10)A","09":"3A"},y={"01":"单相","02":"三相三线","03":"三相四线"},B={1:"220V",2:"3×220/380V",3:"3×57.7/100V",4:"3×380V",5:"3×100V",6:"3×220V",7:"220/380V",8:"400V",99:"380V"},z={12:"0.3",13:"0.5",14:"1",15:"2",16:"3",17:"0.2S",18:"0.2S/0.5S",19:"0.2S/0.5S/5P",20:"0.5/2.0",21:"0.5S",22:"0.5S/1.0",23:"0.5S/2.0",24:"1.0S/1.0",25:"1.0S/2.0",26:"0.2/10p",27:"0.5/10p",28:"0.2S/0.5/10P/10P",29:"0.001S",30:"0.002S",31:"0.005S",32:"0.01S",33:"0.02S",34:"0.05S",35:"0.1S",36:"1.0/2.0",37:"1.0S",38:"0.2S/1.0",39:"0.2S/2.0",40:"0.2/0.5/3P",41:"0.2S/0.2S",42:"0.1ppm",43:"0.2ppm",44:"A(有功)",45:"B(有功)",46:"C(有功)",47:"A",48:"A/2.0",49:"B",50:"B/1.0",51:"B/2.0",52:"C",53:"C/1.0S",54:"C/2.0",55:"D",56:"D/0.5S",57:"D/2.0",71:"2×10-7",72:"5×10-9",73:"1×10-7",74:"1×10-8",75:"2×10-8",76:"3×10-7",77:"3×10-8",78:"5×10-8",79:"6×10-8",80:"7×10-8",81:"9×10-8",82:"5",83:"8×10-9",84:"4×10-9",85:"7×10-9","09":"0.2","08":"0.1","07":"0.05","06":"0.03","05":"0.02","04":"0.01","03":"0.005","02":"0.002","01":"0.001"},M={"00":"原始记录",10:"新装",15:"拆除",20:"更换前",25:"更换后",30:"抄表前",35:"抄表后",40:"暂停",45:"恢复",50:"换抽头前",55:"换抽头后",60:"移入",65:"移出",70:"关系维护前",75:"关系维护后",80:"移动前",85:"移动后"};var w={"电价信息":m,"电表类型":D,"变更标识代码":M,"表箱信息":x,"标定电流类型":b,"相线类别类型":y,"电压类型":B,"准确度类型":z};s("14d9"),s("88a7"),s("271a"),s("5494");const v="localhost"==location.hostname?location.origin:"https://10.150.23.1:8010";console.log(w);class E{constructor(t){this.配备流程=t,this.state=0,this.info="勘查意见",this.color="gery",this.type="error",this.click=this.check,this.suggestion={opinion:void 0,JXFSDM:void 0,isNeedBox:void 0,slots:void 0}}check(){if(this.color=void 0,this.配备流程.勘察信息){this.info=this.配备流程.勘察信息.advice.values.KCYJ;let t=this.配备流程.勘察信息.advice.values.KCYJ.replaceAll("増","增").replace(/03[a-zA-Z0-9]{20,24}/,"").replace(/[JjIiNnGg]{0,4}经?度?[:：;；，, ]{0,2}\d{1,}.\d{3,}/,"").replace(/[WwEeIi]{0,3}纬?度?[:：;；，, ]{0,2}\d{1,}.\d{3,}/,"").replace(/[\n\r\t ，。.,;:；：、]{1,}/g," ").split(" ").filter(t=>t.length).join("，").replaceAll("电表箱","表箱").replace(/[三3][相位]表?箱/g,"三相表箱").replace(/[需要与用配换]{0,}三[相位]表?箱/g,"三相表箱").replace(/[需要与用配换]{1,}表箱/g,"配表箱").replace(/位配?表箱/g,"位表箱").replace(/六位表箱/g,"6位表箱").replace("按规办理，","").replaceAll("一个","")+"。";console.log([this.配备流程.gzdbh,t]),this.info=t;let e=t.replace("同意，","");["。","增容。"].includes(t.replaceAll("同意",""))?(t="同意⚪",this.type="success"):e.includes("箱")||e.includes("表")?(this.type="warning",["配单相表箱。","单相表箱。","配单相表箱。","单相表箱。"].includes(e)?(t="配单相表箱（单相80A + 箱）⚪",this.suggestion.opinion=!0,this.suggestion.JXFSDM="1",this.suggestion.isNeedBox=!0,this.suggestion.slots=1):["三相表箱。","配三相表箱。"].includes(e)?(t="配三相表箱⚪",this.suggestion.opinion=!0,this.suggestion.JXFSDM="3",this.suggestion.isNeedBox=!0,this.suggestion.slots=1):["配一位表箱。","配一位配表箱。","配表箱。","换表箱，不用换表。"].includes(e)?(t="配箱⚪",this.suggestion.opinion=!0,this.suggestion.isNeedBox=!0,this.suggestion.slots=1):["不配表箱。","不用配表箱。","不用表箱。","按规办理，不配表箱。","已有表箱。"].includes(e)?(t="不配箱⚪",this.suggestion.opinion=!0,this.suggestion.isNeedBox=!1,this.suggestion.slots=0):["已有6位表箱。","已有12位表箱。"].includes(e)?(t="不配箱⚪(已有表箱)",this.suggestion.opinion=!0,this.suggestion.isNeedBox=!1,this.suggestion.slots=0):["配6位表箱。"].includes(e)?(t="配6位表箱⚪",this.suggestion.opinion=!0,this.suggestion.isNeedBox=!0,this.suggestion.slots=6):["配12位表箱。"].includes(e)&&(t="配12位表箱⚪",this.suggestion.opinion=!0,this.suggestion.isNeedBox=!0,this.suggestion.slots=12)):this.type="info",this.info=t}else this.info="未有勘查信息",this.type="error";return this.suggestion}}class S{constructor(t){this.配备流程=t,this.state=0,this.info="配备方式",this.color="gery",this.type="success",this.click=this.check}check(){if(this.color=void 0,!this.配备流程.勘察信息)return this.info="未有勘查信息",void(this.type="error");let t=this.配备流程.勘察信息.measureEntities.map(t=>t.values.BGBZDM),e=this.配备流程.勘察信息.meterEntities.map(t=>t.values.BGBZDM),s=this.配备流程.勘察信息.powerEntities.map(t=>t.values.BGBZDM),i=this.配备流程.勘察信息.measureEntities.map(t=>t.values),n={};i.filter(t=>["10","15","25","35","00"].includes(t.BGBZDM)).forEach(t=>n[t.JLDBH]=t),console.log(n=JSON.parse(JSON.stringify(n)));let a=this.配备流程.gzdxx.dataWraps.dataWrapGzdxx.data.ywzl;const o=this.配备流程;if(["F-CSG-MK0513-03-01","F-CSG-MK0513-02-01","F-CSG-MK0513-02-04"].includes(a)){if(1==t.length&&"10"==t[0]&&1==e.length&&"10"==e[0]&&1==s.length&&"10"==s[0]){this.配备流程.info.配备典型="典型新装",console.log("典型新装"),this.info="典型新装";let t=i[0];return this.info+=`【${t.YDRL}kw】,${w.电价信息[t.DJDM].电价}`,this.type="success",void r()}throw this.配备流程.info.配备典型="",this.info="新装--非典型",this.type="warn","新装--非典型"}if(!["F-CSG-MK0513-03-02","F-CSG-MK0513-02-02"].includes(a))throw["F-CSG-MK0514-11-01"].includes(a)?(this.info="销户",this.type="error","销户"):(this.info="未知设定",this.type="error","未知设定");if(2==s.length&&1==s.filter(t=>"20"==t).length&&1==s.filter(t=>"25"==t).length&&2==t.length&&1==t.filter(t=>"20"==t).length&&1==t.filter(t=>"25"==t).length&&2==e.length&&1==e.filter(t=>"10"==t).length&&1==e.filter(t=>"15"==t).length){this.info="典型（同计量点一拆一装换表）";let t=i.find(t=>"20"==t.BGBZDM),e=i.find(t=>"25"==t.BGBZDM);return this.info+=`${t.YDRL}=>【${e.YDRL}kw 】${w.电价信息[e.DJDM].电价}`,this.type="success",void r()}if(2==s.length&&1==s.filter(t=>"20"==t).length&&1==s.filter(t=>"25"==t).length&&3==t.length&&1==t.filter(t=>"10"==t).length&&1==t.filter(t=>"20"==t).length&&1==t.filter(t=>"25"==t).length&&3==e.length&&1==e.filter(t=>"10"==t).length&&1==e.filter(t=>"30"==t).length&&1==e.filter(t=>"35"==t).length){this.info="新增计量点（如加充电桩）";let t=i.find(t=>"10"==t.BGBZDM),e=i.find(t=>"25"==t.BGBZDM);return this.info+=`新：【${t.YDRL} kw】 ${w.电价信息[t.DJDM].电价}，原：【${e.YDRL} kw】 ${w.电价信息[e.DJDM].电价}`,this.type="success",void r()}if(2==s.length&&1==s.filter(t=>"20"==t).length&&1==s.filter(t=>"25"==t).length&&2==t.length&&1==t.filter(t=>"20"==t).length&&1==t.filter(t=>"25"==t).length&&2==e.length&&1==e.filter(t=>"30"==t).length&&1==e.filter(t=>"35"==t).length){this.info="不换表增容（换表前线）";let t=i.find(t=>"20"==t.BGBZDM),e=i.find(t=>"25"==t.BGBZDM);this.info+=`${t.YDRL}=>【${e.YDRL} kw】 ${w.电价信息[e.DJDM].电价}`,this.type="success",r()}else this.info="非典型增容",this.type="error";function r(){let t=o.勘察信息.meterEntities.filter(t=>"10"==t.values.BGBZDM);t.length>1?o.info.表计状态="有多个新表":0!=t.length?(t=t[0].values,"82"==t.BDDLDM&&"01"==t.XXLBDM&&"1"==t.EDDYDM?(o.info.表计状态="单相60A",console.log("单相60A，楼盘内置开关，集中多位表箱")):"83"==t.BDDLDM&&"01"==t.XXLBDM&&"1"==t.EDDYDM?(o.info.表计状态="单相80A",console.log("单相80A，外置开关 220V")):"84"==t.BDDLDM&&"03"==t.XXLBDM&&"2"==t.EDDYDM?(o.info.表计状态="三相80A直入式",console.log("三相80A直入式")):"79"==t.BDDLDM&&"03"==t.XXLBDM&&"2"==t.EDDYDM&&(o.info.表计状态="三相带互感",console.warn("三相带互感，中止"))):o.info.表计状态="没装新表"}}"新增表计功率显示"(){}}class A{constructor(t){this.配备流程=t,this.state=0,this.info="工单类别",this.color="gery",this.type="success",this.click=this.check}check(){if(this.color=void 0,this.配备流程.gzdxx){let t=this.配备流程.gzdxx.dataWraps.dataWrapGzdxx.data.ywzl,e={"F-CSG-MK0513-03-01":"低压居民新装","F-CSG-MK0513-02-01":"低压非居民新装","F-CSG-MK0513-02-04":"低压非居民临时用电","F-CSG-MK0513-03-02":"低压居民增容","F-CSG-MK0513-02-02":"低压非居民增容","F-CSG-MK0514-11-01":"销户"}[t];e?(this.info=e,this.type="success"):(this.info=t,this.type="error")}else this.info="未有工作单信息",this.type="error"}}class j{constructor(t){this.配备流程=t,this.state=0,this.info="工单环节",this.color="gery",this.type="success",this.click=this.check}check(){if(this.color=void 0,this.配备流程.gzdxx){console.log(this.配备流程.gzdxx);let t=this.配备流程.gzdxx.dataWraps.dataWrap.dataList[0].hjmc;["现场服务"].includes(t)?(this.info=t,this.type="success"):(this.info=t,this.type="error")}else this.info="未有工作单信息",this.type="error"}}class G{constructor(t,e,s){this.配备流程=s,this.data=t,this.JLDBH=t.measureEntities[0].JLDBH,this.不合规=[],this.isOnlyOneChange=e,this.勘察配置意见=s.信息检验.勘查信息.check(),this.suggestion={opnion:[],boxInfo:[],meterInfo:[],inductInfo:[],conclusion:void 0,buttons:[]},this.分析={"计量点变化方式":{1:"新",2:"拆",3:"改",0:"意料之外"}[this.分析计量点变化方式()],"供电变化":this.分析供电改变(),"表计变化":{1:"新",2:"拆",3:"换",4:"抄表不换",0:"意料之外"}[this.分析表计变化方式()],"新表配置":this.当前表计配置信息(),"新计量点信息":this.计量更新信息(),"计量更新信息摘要":this.计量更新信息摘要(),"根据计量点信息配表":this.根据计量点信息配表(),"配备典型":this.典型分析(),"测试":this.已配电表信息()},this.表箱信息={"状态":"未查询"},this.分析.根据旧表信息配表=this.根据旧表信息配表(),this.查询表箱(),this.最终配表()}"一键配备"(t,e){let s=w.电表类型[t].withbox.data;return Promise.all([this.配图信息录入(t),this.配箱(e&&s)]).then(()=>this.配备流程.检查())}"配箱"(t){return this.删除表箱().then(()=>t&&this.添加表箱(t))}"查询表箱"(){return k.call(this)}"添加表箱"(t){return _.call(this,t).then(()=>this.查询表箱()).then(()=>this.保存表箱信息())}"删除表箱"(){return this.查询表箱().then(t=>L.call(this,t.dataList)).then(()=>this.查询表箱())}"保存表箱信息"(){return T.call(this).then(()=>W.call(this))}"已配电表信息"(){let t=this.data.meterEntities.filter(t=>["10"].includes(t.BGBZDM));switch(t.length){case 0:return"不需要配表";case 1:return w.电表类型[t[0].BDDLDM]?w.电表类型[t[0].BDDLDM].name:w.相线类别类型[t[0].XXLBDM]+w.标定电流类型[t[0].BDDLDM];default:return"同一计量点配多个电表？"}}"分析计量点变化方式"(){let t=this.data.measureEntities;return 1==t.length&&"10"==t[0].BGBZDM?1:1==t.length&&"15"==t[0].BGBZDM?2:2==t.length&&"20"==t[0].BGBZDM&&"25"==t[1].BGBZDM?3:(console.warn("计量点变化超出预期"),0)}"分析供电改变"(){let t=this.data.measureEntities;if(3==this.分析计量点变化方式()){let e={YDRL:"用电容量",JLZZFLDM:"计量装置分类",JXFSDM:"接线方式",CTBBDM:"TA变比"},s=[];for(let i in e)t[0][i]!=t[1][i]&&s.push(i);return s}return"无换表"}"分析表计变化方式"(){let t=this.data.meterEntities;return 1==t.length&&"10"==t[0].BGBZDM?1:1==t.length&&"15"==t[0].BGBZDM?2:2==t.length&&"10"==t[0].BGBZDM&&"15"==t[1].BGBZDM?3:2==t.length&&"30"==t[0].BGBZDM&&"35"==t[1].BGBZDM?4:(console.warn("表计变化超出预期"),0)}"当前表计配置信息"(){let t=this.data.meterEntities;return this.分析表计变化方式()?t.find(t=>"10"==t.BGBZDM):void console.warn("没有需要配置表计")}"计量更新信息"(){return[...this.data.measureEntities].pop()}"计量更新信息摘要"(){let t=this.计量更新信息(),e={DJDM:"电价代码",YDRL:"用电容量",JLZZFLDM:"计量装置分类",JXFSDM:"接线方式",CTBBDM:"TA变比"};for(let s in e)e[s]=t[s];return e}"需要上互感表标识"(){this.计量更新信息摘要().CTBBDM}"根据计量点信息配表"(){if(this.当前表计配置信息()){let t=this.计量更新信息摘要();if(["1"].includes(t.JXFSDM)){let t=["82","83"];return this.suggestion.meterInfo.push(...t),t}if(["2","3"].includes(t.JXFSDM)&&""==t.CTBBDM){let t=["84"];return this.suggestion.meterInfo.push(...t),t}if(["2","3"].includes(t.JXFSDM)&&"12"==t.CTBBDM){console.log("互感+200");let t=["79"];return this.suggestion.meterInfo.push(...t),t}if(["2","3"].includes(t.JXFSDM)&&"14"==t.CTBBDM){console.log("互感+300");let t=["79"];return this.suggestion.meterInfo.push(...t),t}if(["2","3"].includes(t.JXFSDM)&&"16"==t.CTBBDM){console.log("互感+500");let t=["79"];return this.suggestion.meterInfo.push(...t),t}return console.warn("配表出错"),void console.log(t,this.suggestion.meterInfo)}}"根据旧表信息配表"(){let t=this.分析计量点变化方式(),e=this.分析表计变化方式(),s=this.分析供电改变();if(3==t&&0==s.length&&3==e){let t=this.data.meterEntities.find(t=>"15"==t.BGBZDM),e=w.电表类型[t.BDDLDM].data;if(1!=this.计量更新信息摘要().JXFSDM)return this.分析.根据计量点信息配表;if(["82","83"].includes(t.BDDLDM))return[e];if("73"==t.BDDLDM)return[w.电表类型["82"].data,w.电表类型["83"].data]}}"典型分析"(){let t=this.分析计量点变化方式(),e=this.分析表计变化方式(),s=this.分析供电改变();return 1==t&&1==e?1:2==t&&2==e?2:3==t&&0==s.length&&4==e?3:3==t&&0!=s.length&&4==e?4:3==t&&0==s.length&&3==e?(this.根据旧表信息配表(),5):3==t&&0!=s.length&&3==e?6:(console.warn("配表方法超出预期"),0)}"最终配表"(){let t=this.勘察配置意见,e=this.分析.配备典型,s=this.suggestion;if(console.log(t,e,s),0==s.meterInfo.length&&(this.suggestion.conclusion="不需要配表"),["0","2"].includes(e))this.suggestion.conclusion="不需要配表配箱";else{if(t&&t.opinion?0==t.slots?i(["82","84"],0):"1"==t.JXFSDM&&1==t.slots?i(["83"],1):"3"==t.JXFSDM&&1==t.slots?i(["84","79"],1):1==t.slots?i(["83","84","79"],1):t.slots>1?i(["82","84"],t.slots):this.suggestion.conclusion="没有配表结论":["3","4","5"].includes(e)?i(["82","84","79"],0):(i(["82"],0),i(["83","84","79"],1)),s.opnion.length){let t=s.opnion.map(t=>{let e="";switch(t[1]){case 0:e="不配箱";break;case 1:e="配箱";break;default:e=`配${t[1]}位箱`;break}return s.buttons.push({des:`${w.电表类型[t[0]].name}+${t[1]?"箱":"无箱"}`,func:()=>this.一键配备(t[0],t[1])}),`配${w.电表类型[t[0]].name}，${e}。`});s.conclusion=t.join("\n或")}s.conclusion={1:"标准【新装】",2:"标准【拆除】",3:"【无变化】",4:"无换表【增容】",5:"无增容【换表】",6:"【一装一拆】",0:"未知"}[e]+"，"+s.conclusion,console.log(s.conclusion)}function i(e,i=t.slots){console.log(e,i),console.log(s);let n=s.meterInfo.filter(t=>e.includes(t)).map(t=>[t,i]);s.opnion.push(...n)}}"最终配表2"(){}"配图信息录入"(t){console.log(this);let e=this.配备流程.勘察信息;console.log(t),console.log(e.meterEntities);let s=e.meterEntities.find(t=>t.values.JLDBH==this.JLDBH&&10==t.values.BGBZDM);Object.assign(s.values,w.电表类型[t].data);let i={insertDataSet:{powerEntities:[],transEntities:[],measureEntities:[],meterEntities:[],inductEntities:[],chargeEntities:[],transGroupEntities:[],transToMeasureEntities:[],measureToMeasureEntities:[],measureToMeterEntities:[],measureToInductEntities:[],chargeToMeterEntities:[],appBaseInfo:{status:e.appBaseInfo.status,type:e.appBaseInfo.type,values:{BGBZDM:e.appBaseInfo.values.BGBZDM}},userInfo:{status:e.userInfo.status,type:e.userInfo.type,values:{BGBZDM:e.userInfo.values.BGBZDM}},additionalEntities:{}},deleteDataSet:{powerEntities:[],transEntities:[],measureEntities:[],meterEntities:[],inductEntities:[],chargeEntities:[],transGroupEntities:[],transToMeasureEntities:[],measureToMeasureEntities:[],measureToMeterEntities:[],measureToInductEntities:[],chargeToMeterEntities:[],appBaseInfo:{status:e.appBaseInfo.status,type:e.appBaseInfo.type,values:{BGBZDM:e.appBaseInfo.values.BGBZDM}},userInfo:{status:e.userInfo.status,type:e.userInfo.type,values:{BGBZDM:e.userInfo.values.BGBZDM}},additionalEntities:{}},updateDataSet:{powerEntities:[],transEntities:[],measureEntities:e.measureEntities,meterEntities:e.meterEntities,inductEntities:[],chargeEntities:[],transGroupEntities:[],transToMeasureEntities:[],measureToMeasureEntities:[],measureToMeterEntities:[],measureToInductEntities:[],chargeToMeterEntities:[],appBaseInfo:{status:e.appBaseInfo.status,type:e.appBaseInfo.type,values:{BGBZDM:e.appBaseInfo.values.BGBZDM}},userInfo:{status:e.userInfo.status,type:e.userInfo.type,values:{BGBZDM:e.userInfo.values.BGBZDM}},additionalEntities:{}},appNo:e.appBaseInfo.values.GZDBH,taskNo:e.appBaseInfo.values.FAYXRWH,areaCode:e.appBaseInfo.values.DQBM,advice:e.advice,locationXmlText:e.location,imageTypeMime:"JPEG",appBaseInfo:e.appBaseInfo,userInfo:e.userInfo,sign:"梁嘉炜18566010567@大沥"};return fetch(v+"/YKZX/yk/xckc/txpb/saveDataSetAction.do",{headers:{accept:"text/html, */*; q=0.01","accept-language":"zh-CN,zh;q=0.9,ja;q=0.8","content-type":"application/x-www-form-urlencoded; charset=UTF-8","x-requested-with":"XMLHttpRequest"},referrerPolicy:"strict-origin-when-cross-origin",body:Z({params:JSON.stringify(i)}),method:"POST",mode:"cors",credentials:"include"}).then(t=>t.json())}}class I{constructor(t){this.配备流程=t,this.conclusion="",this.state=0,this.info="综合配备结论",this.color="gery",this.type="success",this.click=this.check,this.multiMuiltmeasureEntitiesInfo=[]}check(){this.isOnlyOneChange=this.配备流程.勘察信息.meterEntities.filter(t=>["10"].includes(t.BGBZDM).length),console.log(this),this.multiMuiltmeasureEntitiesInfo=this.拆分(),this.multiMuiltmeasureEntitiesInfo=this.multiMuiltmeasureEntitiesInfo.map(t=>new G(t,this.isOnlyOneChange,this.配备流程)),1==this.multiMuiltmeasureEntitiesInfo.length?this.conclusion=this.multiMuiltmeasureEntitiesInfo[0].suggestion.conclusion:this.conclusion=this.multiMuiltmeasureEntitiesInfo.map((t,e)=>`计量点${e+1}：${t.suggestion.conclusion}`).join("\n"),this.info=this.conclusion,this.color=void 0}"拆分"(){let t={measureEntities:void 0,inductEntities:void 0,meterEntities:void 0};for(let e in t)t[e]=this.配备流程.勘察信息[e].map(t=>t.values),t[e].sort((t,e)=>t.BGBZDM-e.BGBZDM);return t["measureEntities"]=Array.from(new Set(t["measureEntities"].map(t=>t.JLDBH))).map(e=>({measureEntities:t["measureEntities"].filter(t=>t.JLDBH==e),meterEntities:t["meterEntities"].filter(t=>t.JLDBH==e),inductEntities:t["inductEntities"].filter(t=>t.JLDBH==e)})),t["measureEntities"]}}function k(t=this.配备流程.gzdxx){return fetch(v+"/YKZX/jlyx/zcgl/jljlxpb/jljlxpbgz.do",{headers:{"content-type":"application/x-www-form-urlencoded; charset=UTF-8"},referrerPolicy:"strict-origin-when-cross-origin",body:Z({gzdbh:t.dataWraps.dataWrapGzdxx.data.gzdbh,rwh:t.dataWraps.dataWrap.dataList.find(t=>"现场服务"==t.hjmc).rwh,dqbmString:t.dataWraps.dataWrapGzdxx.data.dqbm,action:"queryJlx"}),method:"POST",mode:"cors",credentials:"include"}).then(t=>t.json()).then(t=>{console.log(t);let e=t.dataWraps.jlxzcjlsecDataWrap.dataList.filter(t=>"10"==t.bgbzdm);if(console.log(e),0==e.length)this.表箱信息.状态="没配表箱";else if(1==this.配备流程.信息检验.勘查分析.multiMuiltmeasureEntitiesInfo.length)e.length>1&&(this.表箱信息.状态="多个表箱"),1==e.length&&(console.log(Object.values(w.表箱信息)),console.log(e[0].wzplbm),this.表箱信息.状态=Object.values(w.表箱信息).find(t=>t.data.wzplbm==e[0].wzplbm).name);else{let t=e.filter(t=>[null,this.JLDBH].includes(t.jldbh));console.log(t),t.length>1&&(this.表箱信息.状态="多个表箱"),1==t.length&&(this.表箱信息.状态=Object.values(w.表箱信息).find(e=>e.data.wzplbm==t[0].wzplbm).name)}return t.dataWraps.jlxzcjlsecDataWrap})}function _(t){return console.log("正在操作添加表箱"),console.log(t),fetch(v+"/YKZX/jlyx/zcgl/fqjlzcrw/fqjlzcrwJlxwhgz.do",{headers:{"content-type":"application/x-www-form-urlencoded; charset=UTF-8"},referrerPolicy:"strict-origin-when-cross-origin",body:Z({"jlxzcjlDataWrap.jsonData":JSON.stringify({data:{gzdbh:this.配备流程.gzdxx.dataWraps.dataWrapGzdxx.data.gzdbh,jldbh:this.JLDBH,yhbh:this.配备流程.yhbh,xbdm:"01",emp_id:"1",cqgsdm:"1",wzplbm:t.wzplbm,bxlxdm:t.bxlxdm,bwzs:1}}),shuliang:"1",zxbzbm:this.配备流程.gzdxx.parameters.xzryZzbm,action:"onAddJlx",IN_PARAM_SYS_TAG:""}),method:"POST",mode:"cors",credentials:"include"}).then(t=>t.json())}function L(t,e=this.gzdxx){let s=t.filter(t=>[null,this.JLDBH].includes(t.jldbh));if(console.log("正在操作删除所有表箱"),s.length)return fetch(v+"/YKZX/jlyx/zcgl/jljlxpb/jljlxpbgz.do",{headers:{"content-type":"application/x-www-form-urlencoded; charset=UTF-8"},referrerPolicy:"strict-origin-when-cross-origin",body:Z({"jlxzcjlsecDataWrap.jsonData":JSON.stringify({dataList:s}),LB:"10",gzdbh:this.配备流程.gzdxx.dataWraps.dataWrapGzdxx.data.gzdbh,dqbmString:this.配备流程.gzdxx.dataWraps.dataWrapGzdxx.data.dqbm,action:"onDelSb",IN_PARAM_SYS_TAG:""}),method:"POST",mode:"cors",credentials:"include"}).then(t=>t.json())}function T(){const t=this.配备流程.gzdxx;return this.查询表箱().then(e=>fetch(v+"/YKZX/jlyx/zcgl/jljlxpb/jljlxpbgz.do",{headers:{"content-type":"application/x-www-form-urlencoded; charset=UTF-8"},referrerPolicy:"strict-origin-when-cross-origin",body:Z({"jlxzcjlsecDataWrap.jsonData":JSON.stringify(e),zxbzbm:t.parameters.xzryZzbm,action:"onSaveJlx",IN_PARAM_SYS_TAG:""}),method:"POST",mode:"cors",credentials:"include"}).then(t=>t.json()).then(t=>{if(t.errorMessage.length)throw t.errorMessage;return e}))}function W(){return fetch(v+"/YKZX/jlyx/zcgl/jlxzcxx/jlxzcxx.do",{headers:{"content-type":"application/x-www-form-urlencoded; charset=UTF-8"},body:Z({dqbmString:"030600",gzdbh:this.配备流程.gzdbh,zcxhjybz:"",isEdit:"Y",action:"retrieve",IN_PARAM_SYS_TAG:""}),method:"POST",mode:"cors",credentials:"include"}).then(t=>t.json()).then(t=>{if(t.dataWraps.dataWrap.dataList.length)return fetch(v+"/YKZX/jlyx/zcgl/jlxzcxx/jlxzcxx.do",{headers:{"content-type":"application/x-www-form-urlencoded; charset=UTF-8"},body:Z({"dataWrap.jsonData":JSON.stringify({dsName:"null",dataList:t.dataWraps.dataWrap.dataList.map(t=>Object.assign(t,{yxxmbh:"1004",yxxmbs:"1000000000145760",zcyydm:"100",zcrybs:"0306001000008282"})),delete:""}),action:"save",IN_PARAM_SYS_TAG:""}),method:"POST",mode:"cors",credentials:"include"})})}function Z(t){let e=[];for(let i in t)e.push(`${encodeURIComponent(i)}=${encodeURIComponent(t[i])}`);let s=e.join("&");return s}var J={"勘查意见检查":E,"配备典型":S,"工作单环节":j,"工作单类别":A,"勘查分析":I};const O="localhost"==location.hostname?location.origin:"https://10.150.23.1:8010",P=[];class X{constructor(t){this.gzdbh=t,this.gzdzy={},this.gzdxx=void 0,this.勘察信息=void 0,this.jlxzcjlsecDataWrap=void 0,this.yhbh=void 0,this.info={"配箱状态":"","表计状态":"",state:"初始化",busy:!1},this.信息检验={"勘查信息":new J.勘查意见检查(this),"工作单环节":new J.工作单环节(this),"工作单类别":new J.工作单类别(this),"勘查分析":new J.勘查分析(this)},P.push(this)}"强制打开配图界面"(){let t=O+`/YKZX/yk/xckc/ykXckcClientPeibiao.do?tacheId=6&ywzlbh=${this.gzdxx.dataWraps.dataWrapGzdxx.data.ywzl}&dqbm=${this.gzdxx.dataWraps.dataWrapGzdxx.data.dqbm}&gzdbh=${this.gzdbh}&rwh=3&editFlag=YES&menuEnable=Y&runModel=02`;window.open(t)}"检查"(){return this.info.state="获取状态信息中",this.查询工单详情().then(()=>this.读取配图界面信息()).then(()=>this.查询表箱配备信息()).then(()=>this.装拆信息录入界面()).then(()=>{this.info.state="检查完成",console.log(this),console.log(this.勘察信息.meterEntities[0].values)})}"配表"(t,e=this.勘察信息){const s={82:{BDDLDM:"82",XXLBDM:"01",EDDYDM:"1",ZQDDJDM:"47"},83:{BDDLDM:"83",XXLBDM:"01",EDDYDM:"1",ZQDDJDM:"47"},84:{BDDLDM:"84",XXLBDM:"03",EDDYDM:"2",ZQDDJDM:"51"},79:{BDDLDM:"79",XXLBDM:"03",EDDYDM:"2",ZQDDJDM:"51"}};return this.配图信息录入(s[t],e)}"配箱"(t=1,e=this.gzdxx,s=this.勘察信息,i=this.yhbh,n=this.jlxzcjlsecDataWrap){const a={82:{wzplbm:"010039102223",bxlxdm:"1041001"},83:{wzplbm:"010039102223",bxlxdm:"1041001"},84:{wzplbm:"010039102511",bxlxdm:"1041002"},79:{wzplbm:"010039102511",bxlxdm:"1041002"}};if(!t&&0!=n.dataList.length)return this.删除所有表箱需求(n.dataList,e);if(t||0!=n.dataList.length){let t=a[s.meterEntities.find(t=>"10"==t.values.BGBZDM).values.BDDLDM];if(console.log(s),console.log(t),0==n.dataList.length)return this.添加表箱(t,e,i).then(()=>this.保存表箱信息);if(1==n.dataList.length&&n.dataList[0].wzplbm==t.wzplbm&&n.dataList[0].bxlxdm==t.bxlxdm)return console.log("当前配备已符合，无需要调整"),this.保存表箱信息();if(1==n.dataList.length&&n.dataList[0].wzplbm!=t.wzplbm&&n.dataList[0].bxlxdm!=t.bxlxdm)return console.log("当前配备错误"),this.删除所有表箱需求(n.dataList,e).then(()=>this.添加表箱(t,e,i)).then(()=>this.保存表箱信息)}else console.log("不需要配箱，当前无箱，跳过")}"配备"(t,e){return this.info.state="正在进行配备",this.gzdxx&&this.勘察信息&&this.jlxzcjlsecDataWrap&&this.yhbh?this.配表(t).then(()=>this.配箱(e)).then(()=>this.检查()):void(this.info.state="未获取基本信息，不可配备")}"配图信息录入"(t,e=this.勘察信息){console.log(t);let s=e.meterEntities.find(t=>10==t.values.BGBZDM);Object.assign(s.values,t);let i={insertDataSet:{powerEntities:[],transEntities:[],measureEntities:[],meterEntities:[],inductEntities:[],chargeEntities:[],transGroupEntities:[],transToMeasureEntities:[],measureToMeasureEntities:[],measureToMeterEntities:[],measureToInductEntities:[],chargeToMeterEntities:[],appBaseInfo:{status:e.appBaseInfo.status,type:e.appBaseInfo.type,values:{BGBZDM:e.appBaseInfo.values.BGBZDM}},userInfo:{status:e.userInfo.status,type:e.userInfo.type,values:{BGBZDM:e.userInfo.values.BGBZDM}},additionalEntities:{}},deleteDataSet:{powerEntities:[],transEntities:[],measureEntities:[],meterEntities:[],inductEntities:[],chargeEntities:[],transGroupEntities:[],transToMeasureEntities:[],measureToMeasureEntities:[],measureToMeterEntities:[],measureToInductEntities:[],chargeToMeterEntities:[],appBaseInfo:{status:e.appBaseInfo.status,type:e.appBaseInfo.type,values:{BGBZDM:e.appBaseInfo.values.BGBZDM}},userInfo:{status:e.userInfo.status,type:e.userInfo.type,values:{BGBZDM:e.userInfo.values.BGBZDM}},additionalEntities:{}},updateDataSet:{powerEntities:[],transEntities:[],measureEntities:e.measureEntities,meterEntities:e.meterEntities,inductEntities:[],chargeEntities:[],transGroupEntities:[],transToMeasureEntities:[],measureToMeasureEntities:[],measureToMeterEntities:[],measureToInductEntities:[],chargeToMeterEntities:[],appBaseInfo:{status:e.appBaseInfo.status,type:e.appBaseInfo.type,values:{BGBZDM:e.appBaseInfo.values.BGBZDM}},userInfo:{status:e.userInfo.status,type:e.userInfo.type,values:{BGBZDM:e.userInfo.values.BGBZDM}},additionalEntities:{}},appNo:e.appBaseInfo.values.GZDBH,taskNo:e.appBaseInfo.values.FAYXRWH,areaCode:e.appBaseInfo.values.DQBM,advice:e.advice,locationXmlText:e.location,imageTypeMime:"JPEG",appBaseInfo:e.appBaseInfo,userInfo:e.userInfo,sign:"梁嘉炜18566010567@大沥"};return fetch(O+"/YKZX/yk/xckc/txpb/saveDataSetAction.do",{headers:{accept:"text/html, */*; q=0.01","accept-language":"zh-CN,zh;q=0.9,ja;q=0.8","content-type":"application/x-www-form-urlencoded; charset=UTF-8","x-requested-with":"XMLHttpRequest"},referrerPolicy:"strict-origin-when-cross-origin",body:N({params:JSON.stringify(i)}),method:"POST",mode:"cors",credentials:"include"}).then(t=>t.json())}"查询工单详情"(t=this.gzdbh){return fetch(O+"/GGZX/xtzc/dbrwgl/dbrwglGzdbl.do?"+N({FLAG:"1",isReadOnly:"N",GZDBH:t,tcbz:"N"}),{headers:{"content-type":"application/x-www-form-urlencoded; charset=UTF-8"},method:"post",mode:"cors",credentials:"include"}).then(t=>t.text()).then(F).then(t=>{this.gzdxx=t,this.信息检验.工作单环节.check(),this.信息检验.工作单类别.check();let e=t.dataWraps.dataWrapGzdxx.data.gzdzy.split("；");return e.forEach(t=>{this.gzdzy[t.split("：")[0]]=t.split("：")[1]}),t})}"读取配图界面信息"(t=this.gzdxx){let e=t.dataWraps.dataWrap.dataList.find(t=>"现场服务"==t.hjmc);if(!e)throw"还未进入现场服务环节";return"现场服务"!=t.dataWraps.dataWrap.dataList[0].hjmc&&console.warn(`当前在${t.dataWraps.dataWrap.dataList[0].hjmc}环节`),fetch(O+"/YKZX/yk/xckc/txpb/readDataset.do",{headers:{"content-type":"application/x-www-form-urlencoded; charset=UTF-8"},body:N({appNo:t.dataWraps.dataWrapGzdxx.data.gzdbh,taskNo:e.rwh,areaCode:"030600"}),method:"POST",mode:"cors",credentials:"include"}).then(t=>t.json()).then(t=>(this.勘察信息=t,this.信息检验.勘查分析.check(),this.信息检验.勘查信息.check(),t))}"查询表箱配备信息"(t=this.gzdxx){return fetch(O+"/YKZX/jlyx/zcgl/jljlxpb/jljlxpbgz.do",{headers:{"content-type":"application/x-www-form-urlencoded; charset=UTF-8"},referrerPolicy:"strict-origin-when-cross-origin",body:N({gzdbh:t.dataWraps.dataWrapGzdxx.data.gzdbh,rwh:t.dataWraps.dataWrap.dataList.find(t=>"现场服务"==t.hjmc).rwh,dqbmString:t.dataWraps.dataWrapGzdxx.data.dqbm,action:"queryJlx"}),method:"POST",mode:"cors",credentials:"include"}).then(t=>t.json()).then(t=>{if(1==t.dataWraps.jlxzcjlsecDataWrap.dataList.length){let e={1041001:"单相",1041002:"三相"}[t.dataWraps.jlxzcjlsecDataWrap.dataList[0].bxlxdm];this.info.配箱状态=e?e+"表箱":"已配备表箱，型号超出预期"+t.dataWraps.jlxzcjlsecDataWrap.dataList[0].bxlxdm}else if(t.dataWraps.jlxzcjlsecDataWrap.dataList.length>1)console.warn("多个表箱"),this.info.配箱状态="多个表箱",t.dataWraps.jlxzcjlsecDataWrap.dataList.forEach(t=>{console.log("已配"+{1041001:"单相",1041002:"三相"}[t.bxlxdm]+"表箱")});else{if(0!=t.dataWraps.jlxzcjlsecDataWrap.dataList.length)throw this.info.配箱状态="未知错误","未知错误";console.log("当前没有配备表箱"),this.info.配箱状态="没配表箱"}return this.jlxzcjlsecDataWrap=t.dataWraps.jlxzcjlsecDataWrap,t})}"装拆信息录入界面"(t=this.gzdxx){return fetch(O+"/YKZX/jlyx/zcgl/jlzzzcxxlr/gdjlJlzzzcxxlr.do?"+N({gzdbh:t.dataWraps.dataWrapGzdxx.data.gzdbh,rwh:t.dataWraps.dataWrap.dataList.find(t=>"现场服务"==t.hjmc).rwh,isEdit:"Y",isFh:"DB",isBl:"bl",dblx:"1",tsdbz:"1",isBatch:"0",fbjoGDXsz:"1",ywzlbh:t.dataWraps.dataWrapGzdxx.data.ywzl,multitaskMenuFlag:"null",multitaskMenuId:"null"}),{headers:{"content-type":"application/x-www-form-urlencoded"},referrerPolicy:"strict-origin-when-cross-origin",body:N({"dataWrapGzdxx.jsonData":JSON.stringify({dataList:[],pageInfo:{allPageNum:0,allRowNum:0,curPageNum:0,rowOfPage:0},data:t.dataWraps.dataWrapGzdxx.data,query:{}})}),method:"POST",mode:"cors",credentials:"include"}).then(t=>t.text()).then(F).then(t=>(this.yhbh=t.parameters.yhbh,t))}"添加表箱"(t,e=this.gzdxx,s=this.yhbh){return console.log("正在操作添加表箱"),console.log(t),fetch(O+"/YKZX/jlyx/zcgl/fqjlzcrw/fqjlzcrwJlxwhgz.do",{headers:{"content-type":"application/x-www-form-urlencoded; charset=UTF-8"},referrerPolicy:"strict-origin-when-cross-origin",body:N({"jlxzcjlDataWrap.jsonData":JSON.stringify({data:{gzdbh:e.dataWraps.dataWrapGzdxx.data.gzdbh,yhbh:s,xbdm:"01",emp_id:"1",cqgsdm:"1",wzplbm:t.wzplbm,bxlxdm:t.bxlxdm,bwzs:1}}),shuliang:"1",zxbzbm:e.parameters.xzryZzbm,action:"onAddJlx",IN_PARAM_SYS_TAG:""}),method:"POST",mode:"cors",credentials:"include"}).then(t=>t.json())}"保存表箱信息"(t=this.gzdxx){return this.查询表箱配备信息().then(t=>t.dataWraps.jlxzcjlsecDataWrap).then(e=>fetch(O+"/YKZX/jlyx/zcgl/jljlxpb/jljlxpbgz.do",{headers:{"content-type":"application/x-www-form-urlencoded; charset=UTF-8"},referrerPolicy:"strict-origin-when-cross-origin",body:N({"jlxzcjlsecDataWrap.jsonData":JSON.stringify(e),zxbzbm:t.parameters.xzryZzbm,action:"onSaveJlx",IN_PARAM_SYS_TAG:""}),method:"POST",mode:"cors",credentials:"include"}).then(t=>t.json()).then(t=>{if(t.errorMessage.length)throw t.errorMessage;return e}))}"删除所有表箱需求"(t,e=this.gzdxx){if(console.log("正在操作删除所有表箱"),t.length)return fetch(O+"/YKZX/jlyx/zcgl/jljlxpb/jljlxpbgz.do",{headers:{"content-type":"application/x-www-form-urlencoded; charset=UTF-8"},referrerPolicy:"strict-origin-when-cross-origin",body:N({"jlxzcjlsecDataWrap.jsonData":JSON.stringify({pageInfo:{allPageNum:1,allRowNum:1,curPageNum:1,rowOfPage:200},dsName:"null",dataList:t}),LB:"10",gzdbh:e.dataWraps.dataWrapGzdxx.data.gzdbh,dqbmString:e.dataWraps.dataWrapGzdxx.data.dqbm,action:"onDelSb",IN_PARAM_SYS_TAG:""}),method:"POST",mode:"cors",credentials:"include"}).then(t=>t.json())}"打印服务情况表"(t=this.gzdbh,e="pdf",s=this.gzdbh){let i=void 0,n=void 0,a=void 0,o=void 0;return r(t).then(l).then(c).then(()=>"excel"==e?h(e,s):d(e,s));function r(t){return fetch(O+"/YKZX/yk/xckc/ykXckc.do",{headers:{"content-type":"application/x-www-form-urlencoded; charset=UTF-8","x-requested-with":"XMLHttpRequest"},body:N({gzdbh:t,dymc:"打印服务情况表",action:"scbdbs",IN_PARAM_SYS_TAG:""}),method:"POST",mode:"cors",credentials:"include"}).then(t=>t.json()).then(t=>(i=t.parameters.bdbs,i))}function l(){return fetch(O+"/PMS/yk/xckc/ykXckcdy.do?"+N({gzdbh:t,fwqkb:"fwqkb",appcontext:"PMS",multitaskMenuFlag:"null",multitaskMenuId:"null"}),{headers:{"content-type":"application/x-www-form-urlencoded"},body:N({action:"printMulti",reportName:"../printFiles/wcbb/yk/ykjmxcfwqkbnew.raq",reportDSName:"ds1",currentDataWrap:"",viewResult:"printM",printFormId:i}),method:"POST",mode:"cors",credentials:"include"}).then(t=>t.text()).then(t=>{let e=t.substr(t.indexOf('name="reportName" value="')+25);e=e.substr(0,e.indexOf("/>")-2);let s=t.substr(t.indexOf('name="cacheId" value="')+22);s=s.substr(0,s.indexOf("/>")-2);let i=t.substr(t.indexOf('"reportName":')+14);return i=i.substr(0,i.indexOf('"funcBarFontColo')-2),n=e,a=s,o=i,e})}function c(){return fetch(O+"/PMS/viewReportServlet",{headers:{"content-type":"application/x-www-form-urlencoded"},body:N({action:"3",reportName:n,cacheId:a,width:"0",height:"0",needPage:"no"}),method:"POST",mode:"cors",credentials:"include"})}function h(t,e=e){let s=O+"/PMS/ExportServlet?"+N({action:"6",format:t,object:"complex",isNeedFormula:"0",dispRatio:"100",pdfExportStyle:"text,1",excelPageStyle:"0",excelFormat:"2003",wordFormat:"2003",reportName:n,cacheId:a,vrCacheId:"VR_2",saveAsName:e,viewReportListener:"",needExportRat:"no",needExportFlashGraph:"yes",reportType:"1",serverPath:n,textDataSeparator:"",textDataLineBreak:""});return u(s,t,e)}function d(t,e=e){let s=O+"/PMS/viewReportServlet?"+N({action:"6",format:t,isNeedFormula:"0",dispRatio:"100",reportName:n,cacheId:a,textDataSeparator:"",textDataLineBreak:"",excelPageStyle:"0",excelFormat:"null",wordFormat:"null",excelUsePaperSize:"no",width:"0",height:"0",columns:"0",pdfExportStyle:"graph,1",backAndRefresh:"yes",saveAsName:"hggiu1"});return u(s,t,e)}function u(t,e,s=s){return fetch(t,{headers:{"content-type":"application/x-www-form-urlencoded"},method:"POST",mode:"cors",credentials:"include"}).then(t=>t.blob()).then(t=>{const i=URL.createObjectURL(t);let n=document.createElement("a");n.download=s+{pdf:".pdf",word:".doc",excel:".xls"}[e],n.href=i,document.body.appendChild(n),n.click(),n.remove()})}}"移除"(){P.splice(P.indexOf(this),1)}}function N(t){let e=[];for(let i in t)e.push(`${encodeURIComponent(i)}=${encodeURIComponent(t[i])}`);let s=e.join("&");return s}function F(t){let e=t.substr(t.indexOf('id="json_textarea">')+20);return e=e.substr(0,e.indexOf("</textarea>")),JSON.parse(e)}var Y={"配表流程":X,"配表队列":P},R=s("0798"),C=function(){var t=this,e=t._self._c;return e(R["a"],{attrs:{text:"",outlined:"",dense:"",type:t.myValue.type,color:t.myValue.color},on:{click:function(e){return t.myValue.click()}}},[t._v(t._s(t.myValue.info))])},q=[],K={name:"JRalert",props:{myValue:Object},data:()=>({}),methods:{},components:{},watch:{},mounted:function(){}},$=K,U=s("2877"),V=Object(U["a"])($,C,q,!1,null,null,null),H=V.exports;window.计量配表=Y;var Q={name:"App",data:()=>({cookies:"",newGzdbh:"03060018000359594433",muiltTask:"03060018000358793332\n03060018000358924779\n03060018000359559034","计量配表":Y,database:w}),methods:{"设置cookies"(t){console.log("尝试"),t.replaceAll(" ","").split(";").forEach((async function(t){document.cookie=`${t.split("=")[0]}=${t.split("=")[1]}; max-age=99999999; domain=${location.hostname};path=/`}))},"制表"(){let t=Y.配表队列.map(t=>{let e={"工作单编号":t.gzdbh,"用电地址":t.gzdzy.用电地址.replace(/广?东?省?佛?山?市?南?海?区?/,""),"结论":t.信息检验.勘查分析.conclusion};return e});console.table(t)}},watch:{},components:{JRalert:H}},tt=Q,et=Object(U["a"])(tt,p,f,!1,null,"1b5ac7c8",null),st=et.exports,it=s("f309");i["a"].use(it["a"]);var nt=new it["a"]({});i["a"].config.productionTip=!1,new i["a"]({vuetify:nt,render:t=>t(st)}).$mount("#app")}});